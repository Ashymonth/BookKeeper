# BookKeeper
Программа для ведения учета.
Основной функционал - совмещение счетов из excel файлов с платежами из html, возможность создавать тарифы и льготы для домов/счетов.

## Технологии:
* Интерфейс - WindowsFroms + MetroUI.
* База данных - Localdb, EntityFramework6 + EntityFrameworkPlus.
* Взаимодействие с Excel - ClosedXML + Spire.xls.
* Взаимодействие с Html - Html agility pack.

## Интерфейс тулбара:

### Импорт:

* Реестр  - загрузка реестра из excel файлов.
* Платежи - загрузка платежей из html/htm файлов.

### Дома:

* Добавить - Добавление дома в базу.
* Удалить - Удаление дома из базы.

### Счета:

* Выделить не оплаченные - выделяет красным цветам счета, у которых есть задолжности за выбранный периуд. 
* Выделить новые - выделяет зеленым цветом счета, которые были впервые добавлены в базу. 
* Сбросить - устанавливает цвет по умолчанию.

### База данных:

* Бэкап - создает экземпляр текущей базы данных.
* Восстановить - загружает базу данных из сохраненного экземпляра.

## Отчет по месяцам: 

Отображает данные по счетам за выбранный периуд времени без учета архивных счетов.

* Архив - отображает счета занесенные в архив.

## Тарифы:
Отображает все установленные тарифы на дома. По умолчанию, для каждого дома установлен тарифы в 166 рублей. Выбор нескольких тарифов осуществляется путем установки флага в чекбоксе.

* Добавить - добавляет тариф на выбранный дом.
* Изменить цену - изменение цены на выбранные тарифы.
* Отправить в архив - тариф будет перемещён в архив.
* Удалить - безвозвратное удаление выбранных тарифов.

### Архив:

* Показать архивные тарифы - отоброжает тарифы, помеченные как архивные.
* Скрыть - скрывает отображение архивных тарифов.

## Льготы:

* Добавить счет - добавляет льготу на выбранный счет. При установки льготы, нужно указать, сколько людей проживает в квартире и сколько из них льготников. Льгота рассчитывается по формуле: (тариф / кол-во проживающих) - процент льготы. 
* Добавить квартиру - так и не ясно, нужна ли будет эта функция. Пока что она не используется в программе.
* Отправить в архив - льгота будет перемещён в архив.
* Удалить - безвозвратное удаление выбранных льгот.

### Архив:

* Показать архивные тарифы - отоброжает льготы, помеченные как архивные.
* Скрыть - скрывает отображение архивных льгот.

### Проценты и описание:

* Добавить процентную ставку - добавляет новую процентную ставку по льготам.
* Добавить описание - добавляет новое описание для льгот.

## Общий отчет: 
Отображает сумму поступлений и начислений за выбранный периуд времени. Проценты - отображает процентное соотношение поступлений и начислений.

* Сформировать общий отчет - формирует отчет по всем домам выбранной улицы.
* Сформировать отчет - формирует отчет по выбранной улице/дому/корпусу.
* Экспорт в эксель - сохраняет сформированный отчет в excel таблицу.

## Отчет по всем счетам: 
Формирует отчет по всем счетам за выбранный периуд времени.
